<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>MARSOL Â· Cost Control</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:'Inter',sans-serif}
body{background:#f2f4f8;color:#1c1c1e}

/* SPLASH */
#splash{
  position:fixed;inset:0;
  background:linear-gradient(180deg,#0f4c75,#3282b8,#bbe1fa);
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;
  color:#fff;z-index:1000
}
#splash h1{font-size:32px;font-weight:700}
#splash p{margin-top:8px;opacity:.85}

/* LOGIN */
#login,#app{display:none;padding:20px}
.login-box{
  max-width:360px;margin:80px auto;
  background:#fff;border-radius:20px;
  padding:25px;box-shadow:0 10px 25px rgba(0,0,0,.1)
}
.login-box h2{text-align:center;margin-bottom:20px}
button{
  width:100%;padding:14px;border:none;
  border-radius:14px;font-weight:600;
  background:#007aff;color:#fff;margin-bottom:12px
}
input{
  width:100%;padding:14px;border-radius:14px;
  border:1px solid #ccc;margin-bottom:12px
}

/* DASHBOARD */
h1{text-align:center;margin-bottom:20px}
.dashboard{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:15px;margin-bottom:25px
}
.card{
  border-radius:20px;padding:20px;color:#fff;
  box-shadow:0 10px 25px rgba(0,0,0,.08)
}
.ingreso{background:linear-gradient(135deg,#34c759,#2ecc71)}
.gasto{background:linear-gradient(135deg,#ff3b30,#ff6b6b)}
.saldo{background:linear-gradient(135deg,#007aff,#5ac8fa)}

canvas{background:#fff;border-radius:20px;padding:20px}
</style>
</head>

<body>

<!-- SPLASH -->
<div id="splash">
  <h1>MarSol Cost Control</h1>
  <p>VersiÃ³n 1.0 Â· 2026</p>
</div>

<!-- LOGIN -->
<div id="login">
  <div class="login-box">
    <h2>Selecciona tu perfil</h2>
    <button onclick="selectUser('ana')">Ana MarÃ­a</button>
    <button onclick="selectUser('camilo')">Camilo AndrÃ©s</button>

    <input type="password" id="password" placeholder="ContraseÃ±a"
           autocomplete="current-password">
    <button onclick="loginUser()">Ingresar</button>
    <p id="loginMsg" style="color:red;text-align:center"></p>
  </div>
</div>

<!-- APP -->
<div id="app">
  <h1>MARSOL ðŸ’°</h1>

  <div class="dashboard">
    <div class="card ingreso"><span>Ingresos</span><h2 id="totalIngresos">COP 0</h2></div>
    <div class="card gasto"><span>Gastos</span><h2 id="totalGastos">COP 0</h2></div>
    <div class="card saldo"><span>Saldo</span><h2 id="saldo">COP 0</h2></div>
  </div>

  <canvas id="grafico"></canvas>
</div>

<script>
/* ===== DOM REFERENCES ===== */
const splash = document.getElementById("splash");
const login = document.getElementById("login");
const app = document.getElementById("app");
const passwordInput = document.getElementById("password");
const loginMsg = document.getElementById("loginMsg");

/* ===== SPLASH ===== */
setTimeout(() => {
  splash.style.display = "none";
  checkSession();
}, 1500);

/* ===== AUTH ===== */
let currentUser = null;

/* ContraseÃ±as hasheadas (ejemplo)
   ana: 1234
   camilo: 5678
*/
const USERS = {
  ana: "03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4",
  camilo: "f8638b979b2f4f793ddb6dbd197e0ee25a7a6ea32b98d3d4f2f9c7c8c0b89b0d"
};

function selectUser(user) {
  currentUser = user;
  loginMsg.textContent = `Usuario seleccionado: ${user === 'ana' ? 'Ana MarÃ­a' : 'Camilo AndrÃ©s'}`;
}

async function hash(text) {
  const data = new TextEncoder().encode(text);
  const buf = await crypto.subtle.digest("SHA-256", data);
  return Array.from(new Uint8Array(buf))
    .map(b => b.toString(16).padStart(2, "0"))
    .join("");
}

async function loginUser() {
  if (!currentUser || !passwordInput.value) {
    loginMsg.textContent = "Selecciona un usuario e ingresa la contraseÃ±a";
    return;
  }

  const hashed = await hash(passwordInput.value);
  if (hashed === USERS[currentUser]) {
    localStorage.setItem("marsolUser", currentUser);
    showApp();
  } else {
    loginMsg.textContent = "ContraseÃ±a incorrecta";
  }
}

function checkSession() {
  const saved = localStorage.getItem("marsolUser");
  if (saved) {
    currentUser = saved;
    showApp();
  } else {
    login.style.display = "block";
  }
}

function showApp() {
  login.style.display = "none";
  app.style.display = "block";
}
</script>

</body>
</html>
